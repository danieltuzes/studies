# studies

New fields I learn or give presentations about.

- [random](#random)
- [random-meta](#random-meta)
  - [How to create presentations in different formats from markdown?](#how-to-create-presentations-in-different-formats-from-markdown)
  - [Software requirements](#software-requirements)
    - [VS Code for development environment](#vs-code-for-development-environment)
    - [miniconda](#miniconda)
    - [Miktex](#miktex)
    - [revealjs](#revealjs)
  - [Create html](#create-html)
  - [Create pptx](#create-pptx)
  - [Create pdf with latex](#create-pdf-with-latex)

## random

This is a presentation material and also an experiment how to create a presentation in markdown and convert it to powerpoint, revealjs and pdf for which I will use pandoc, the revealjs JS library and latex (from the Miktex distribution) and the beamer template.

## random-meta

### How to create presentations in different formats from markdown?

In a corporate environemnt, it is important to be aware of software limitations and I will keep this in mind during the presentation development. All software should be able to installed without admin privileges, or are so basic all corporates should allow them to require.

### Software requirements

This is not the only set of software which makes it possible to create the presentations, but one way to achieve it.

- VS Code: the development environment
- miniconda: this will help to install pandoc, the converter between markdown and all other languages like power point, latex and html
- Miktex: the latex distribution. This creates the pdf from the latex file generated by pandoc.
- revealjs: this is needed for pandoc and for the html to create and display the slideshow in html
- power point: if you want to view the `pptx` output, you need this one too
- git: optional, with this, you can add revealjs as a submodule and refresh it

#### VS Code for development environment

I use VS Code for development, because

- it supports all the languages I am working with: C++, python, Markdown, html, jinja, latex, vba, shell
- has integrated git support, however, it is not the best in the class, PyCharm's built in git manager seems to be better, but GitHub Desktop, a git manager not only for github repos, is maybe the best
- small, fast and highly customizable. It is possible to preview pdfs, markdowns, and many other formats

Once you have it, I suggest to install the following extensions at least:

- `ms-python.python` package for managing python and anaconda
- `yzhang.markdown-all-in-one` to edit markdown easier

#### miniconda

To install pandoc with conda, you need miniconda. You can also install pandoc individually, but if you already have conda, then there is no need to get pandoc individually.

You can also install miniconda yourself, after downloading it from the internet, but I'll suppose you already have it.

Open an anaconda prompt and create a new environment, where you have the most modern pandoc:

```PowerShell
(base) C:\Users\tuzes>conda create --name pandoc pandoc
(base) C:\Users\tuzes>conda activate pandoc
(pandoc) C:\Users\tuzes>
```

Here we installed pandoc with conda, and activated it. Whenever you need pandoc, you will need to start a command prompt that knows where conda is and activate an environment where pandoc can be found. You can also set up VS Code so that when you start a new terminal, it starts a kind of an Anaconda prompt that knows where conda is therefore you can activate the pandoc environment.

#### Miktex

Download and install Miktex, and update the packages as well. If you don't have admin rights, you can still install packages into your home directory, but most probably Miktex package manager and installer is not allowed to reach the internet from a corporate environment, in which case you need to download tha packages manually and install them, or download the files and place them right next to your generated latex files, such as `beamer.cls`, evershi.sty and `l3backend-padftex.def`.

It may happen that you don't have pdflatex in your VS Code path, but you have it in your Anaconda prompt's path. Although I don't understand why it happens, you can still add the path to your pdflatex into your integrated PowerShell terminal. Edit the `settings.json` file in your `.vscode` folder (Ctrl+Shift+P, then type Open Workspace Settings (JSON)) and add the following lines to the beginning of the file

```JSON
{
    "terminal.integrated.shellArgs.windows": [
        "-NoExit",
        "$Env:Path += ';C:\\Users\\tuzes\\AppData\\Local\\Programs\\MiKTeX\\miktex\\bin\\x64\\'"
    ],
    "markdownlint.config": {
        "MD025": false
    },

}
```

Modify the path to your pdflatex in the script.

#### revealjs

You need this couple of JS and CSS files for the html output to work properly. To be more precise, your software will generate the CSS file from SCSS files you download with revealjs.

If you don't version track your repo or don't want to add [revealjs](https://revealjs.com/installation/) as a submodule, then [download it from github as a zip](https://github.com/hakimel/reveal.js/archive/master.zip), and unpack it as a folder called `reveal.js` next to your presentation file `random.md`.

If you have git and want to add revealjs as a submodule. Open git bash, cd into your repo and issue

```bash
tuzes@PCname MINGW64 ~/source/repos/studies (main)
$ git submodule add https://github.com/hakimel/reveal.js.git
```

This will download the repository and checkout the lates version.

### Create html

Activate your python environment where you have `pandoc` installed and issue

```PowerShell
(pandoc) PS C:\Users\tuzes\source\repos\studies> pandoc -t revealjs -o random.html --self-contained -V revealjs-url=reveal.js --mathjax random.md
```

This tells pandoc to

- [target](https://pandoc.org/MANUAL.html#option--to) revealjs,
- the [output file](https://pandoc.org/MANUAL.html#option--output) is `random.html`,
- it should be [self-contained](https://pandoc.org/MANUAL.html#option--self-contained), i.e. don't depend on external files (like pictures, scripts and styles), but inclue them all in the file,
- to use the folder `reveal.js` as the source of the revealjs instead of `https://unpkg.com/reveal.js@^4/` to which you may have no access
- [Use mathjax (from cloudfare)](https://pandoc.org/MANUAL.html#option--mathjax) to display math equations
- [use input file](https://pandoc.org/MANUAL.html#synopsis) `random.md`

Pandoc will then generate `random.html` within 10 s. Open it with Firefox and use the arrow keys for navigation.

### Create pptx

Issue

```PowerShell
(pandoc) PS C:\Users\tuzes\source\repos\studies> pandoc -o random.pptx random.md
```

This will create a power point presentation file that can be opened with power point 2013 or newer.

### Create pdf with latex

Issue

```PowerShell
(pandoc) PS C:\Users\tuzes\source\repos\studies> pandoc -t beamer -o random.pdf random.md
```

This tells pandoc to

- [target](https://pandoc.org/MANUAL.html#option--to) beamer, a presentation template from latex,
- the [output file](https://pandoc.org/MANUAL.html#option--output) is `random.pdf`, this will be created by pdflatex from an intermediate, temporal latex file
- from the input file `random.md`

If you don't have the latex packages to compile the temporal latex file, you will need to install them. These files (from these packages) are needed:

- beamer.cls (beamer)
- geometry.sty (geometry)
- ltxcmds.sty (ltxcmds)
- infwarerr.sty (infwarerr)
- kvsetkeys.sty (kvsetkeys)
- kvdefinekeys.sty (kvdefinekeys)
- pdfescape.sty (pdfescape)
- hycolor.sty (hycolor)
- letltxmacro.sty (letltxmacro)
- auxhook.sty (auxhook)
- kvoptions.sty (kvoptions)
- intcalc.sty (intcalc)
- etexcmds.sty (etexcmds)
- bitset.sty (bitset)
- bigintcalc.sty (bigintcalc)
- rerunfilecheck.sty (rerunfilecheck)
- uniquecounter.sty (uniquecounter)
- sansmathaccent.sty (sansmathaccent)
- etc...

You may need to add a proxy to your miktex pacakge manager and try to choose a good repository. If you cannot you need to download the files manually, and either set up a local repository server or copy the requested file next to the .md file.
